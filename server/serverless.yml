org: # FILL ME
name: # FILL ME

component: express@1.5.3
app: server
stage: prod

inputs:
  src: ./build/app
  memory: 512
  timeout: 29
  description: # FILL ME
  domain: ${env:SERVER_SERVICE_DOMAIN}
  region: us-east-1 # Cannot deploy to "ap-southeast-2" because main domain certificate ( manged by ACM ) is in "us-east-1"
  layers:
    - arn:aws:lambda:us-east-1:***:layer:LAYER_NAME:${env:NODE_MODULES_LAMBDA_LAYER_VERSION}
    - arn:aws:lambda:us-east-1:***:layer:LAYER_NAME:${env:PRISMA_CLIENT_LAMBDA_LAYER_VERSION}
    - arn:aws:lambda:us-east-1:***:layer:LAYER_NAME:${env:LIBS_LAMBDA_LAYER_VERSION}
  env:
    NODE_ENV: production
    APP_ORIGIN: ${env:APP_ORIGIN}
    PRIMARY_DOMAIN: ${env:PRIMARY_DOMAIN}
    GRAPHQL_ENDPOINT: ${env:GRAPHQL_ENDPOINT}
    CLIENT_SEO_SERVICE_DOMAIN: ${env:CLIENT_SEO_SERVICE_DOMAIN}
    CLIENT_SERVICE_DOMAIN: ${env:CLIENT_SERVICE_DOMAIN}
    JWT_SECRET: ${env:BAM_JWT_SECRET}
    PRISMA_DATABASE_URL: ${env:PRISMA_DATABASE_URL}
    PRISMA_BINARY_TARGET: rhel-openssl-1.0.x
